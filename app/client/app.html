<head>
    <title>Secret Space Santa</title>

    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>

<body>
    <div class="sss-heading">
        <h1>Secret Space Santa</h1>
    </div>

    <div class="container">
        <div class="row">
            <div class="col-md-8">
                <p class="bg-danger">
                    If you want to contribute to this project, check out <a href="https://github.com/jletellier/secret-space-santa">this GitHub repository</a>.
                </p>

                {{> user }}

                {{> admin }}
            </div>
            <div class="col-md-4">
                {{> statistics }}
                <div class="bg-warning sss-login">
                    {{> loginButtons }}
                </div>
            </div>
        </div>

        <div class="row">

        </div>
    </div>

    <div class="modal fade sss-share-item-modal" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-sm" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Share ID:</h4>
                </div>
                <div class="modal-body">
                    <span class="sss-share-item-modal-content"></span>
                </div>
            </div>
        </div>
    </div>
</body>

<template name="statistics">
    <div class="bg-danger">
        <p>Event coming up <span class="text-danger">{{ remaining }}</span></p>
        <p>Participants: <span class="text-danger">{{ participantCount }}</span></p>
        <p>Participants drawn: <span class="text-danger">{{ drawnCount }}</span></p>
    </div>
</template>

<template name="user">
    {{# if queryUser }}
        <div class="sss-user bg-warning">
            <p>Hi <span>{{ queryUser.name }}</span>,</p>
            <p>You are the Secret Santa for: <span class="user-drawn text-success"><strong>{{ queryUser.drawnParticipant }}</strong></span>.</p>
        </div>
    {{/ if }}
</template>

<template name="admin">
    <div class="sss-admin bg-warning">
        {{# if currentUser }}
            {{# if hasAdminPermission }}
                <div class="clearfix">
                    <div class="pull-left"><h2>Santa Claus' Area</h2></div>
                    <div class="pull-right">
                        <button type="button" class="auto-assign btn btn-primary">
                            <span class="glyphicon glyphicon-random"></span>
                            Auto assign
                        </button>
                        <button type="button" class="add-item btn btn-success">
                            <span class="glyphicon glyphicon-plus-sign"></span>
                            Add participant
                        </button>
                    </div>
                </div>
                {{> adminList }}
            {{ else }}
                <p>You are not Santa Claus. Get out of here!</p>
            {{/ if }}
        {{/ if }}
    </div>
</template>

<template name="adminList">
    <table class="table-striped">
        <thead><tr>
            <th>Participant</th>
            <th>Drawn participant</th>
            <th></th>
        </tr></thead>
        <tbody>
            {{# each participants }}
                {{> adminListItem }}
            {{/ each }}
        </tbody>
    </table>
</template>

<template name="adminListItem">
    <tr>
        <td>{{ name }}</td>
        <td>
            {{# if reveal }}
                <select class="form-control">
                    <option>{{ drawnParticipant }}</option>
                    {{# each freeParticipants }}
                        <option>{{ name }}</option>
                    {{/ each }}
                </select>
            {{ else }}
                <span class="glyphicon glyphicon-user"></span> (hidden)
            {{/ if }}
        </td>
        <td>
            <span class="sss-item reveal-item glyphicon
                {{# if reveal }}glyphicon-eye-close{{ else }}glyphicon-eye-open{{/ if }}">
            </span>
            <span class="sss-item remove-item glyphicon glyphicon-trash"></span>
            <span class="sss-item share-item glyphicon glyphicon-share"></span>
        </td>
    </tr>
</template>
